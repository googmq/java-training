本节实例数据库请见[文件](./1.2/create_table.sql)

# B+Tree索引用法

B+Tree使用多路树型结构存放数据，适用与全键值、键值范围、和键前缀查找等.

## B+Tree适用范围

1. 索引列全值匹配：explain select id from t_1_2 where name = 'Mike';
2. 索引列最左值匹配：explain select * from t_1_2 where mobile like '1381234%';
3. 索引列范围值查询：explain select id from t_1_2 where age > 15 and age < 20;
4. 多列索引中，按照索引建立顺序，精确匹配某一列并范围查找另外一列：explain select id from t_1_2 where age =15 and mobile like '1381234%';
5. 只访问索引并使用索引值可以完成的查询：explain select mobile from t_1_2 where age > 20;

## B+Tree使用限制

1. 使用多列索引时必须按照索引的建立顺序
2. 使用多列索引时不能跳过中间的列
3. 使用多列索引时一旦出现范围查询，后面的列无法再使用索引

## 常用数据库引擎支持

InnoDB和MyISAM引擎支持B+Tree索引。

# 哈希索引用法

哈希索引使用哈希表存放索引结构，只有精确匹配到所有索引列的查询才有效。

## 哈希索引适用范围

1. 精确匹配索引所有列的值

## 哈希索引使用限制

1. 哈希索引只包含索引值和行指针，不存字段的值，不能使用索引来避免回表读数据
2. 哈希索引是无序排列，无法用来做排序
3. 只支持等值匹配查询，不支持范围运算查询
4. 只支持索引值全匹配，不支持部分匹配
5. 发生哈希冲突时会导致性能下降，需要避免某些哈希值过热
6. 哈希冲突多时，维护索引的代价会很高

## 常用数据库引擎支持

InnoDB和MyISAM引擎不支持哈希索引，Memory引擎支持哈希索引

# B+Tree索引和哈希索引的比较

|                    |  B+Tree索引  |                        哈希索引                        |
| ------------------ | :----------: | :----------------------------------------------------: |
| 索引列等值查询速度 | 快，O(logn)  | 更快，O(1)，但是在出现哈希冲突热点的时候性能会大幅下降 |
| 索引列前缀匹配查询 |     支持     |                         不支持                         |
| 范围查询           |     支持     |                         不支持                         |
| 覆盖索引           |     支持     |                         不支持                         |
| 排序加速           | 可以用来排序 |                      不能用来排序                      |